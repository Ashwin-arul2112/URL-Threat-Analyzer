# URL-Threat-Analyzer

A full-stack AI-powered malicious URL detection and threat intelligence platform.
It combines machine learning classification, handcrafted URL feature analysis, live WHOIS and HTTP scanning, and a modern interactive dashboard.

Features
AI-Driven URL Classification

A trained ensemble ML model classifies URLs as safe or risky using lexical, structural, and statistical features.
(Defined in feature_extraction.py and model_training.py)

Live WHOIS and HTTP Network Analysis

Real-time URL inspection that gathers:

IP resolution

Domain age

Redirect chain

HTTP response latency

Final resolved URL
(Implemented in live_scan.py)

Interactive Web Application

Flask and Jinja-based UI that includes:

Home page with AI Scan and Live Scan

Dashboard with charts and metrics

Batch CSV scanning interface

Detailed report view pages
Templates come from: index.html, dashboard.html, batch.html, batch_result.html, report_view.html, layout.html.

MongoDB Storage

Every scan is stored for analytics, reporting, and historical tracking.

Batch Processing Support

Chunk-based feature extraction and automatic merging for large datasets using utils.py.

Project Structure
smart-url-threat-analyzer/
│
├── backend/
│   ├── feature_extraction.py
│   ├── live_scan.py
│   ├── model_training.py
│   ├── predict.py
│   ├── utils.py
│   ├── model/
│   │   ├── phiusiil_smartphish.pkl
│   │   └── phiusiil_smartphish_scaler.pkl
│
├── web/
│   ├── templates/
│   │   ├── layout.html
│   │   ├── index.html
│   │   ├── dashboard.html
│   │   ├── batch.html
│   │   ├── batch_result.html
│   │   ├── report_view.html
│   └── static/
│
├── data/
│   ├── phish_url.csv
│   ├── features_auto_generated.csv
│
├── app.py
├── requirements.txt
└── README.md


HTML templates used:

layout.html 

layout

index.html 

index

dashboard.html 

dashboard

batch.html 

batch

batch_result.html 

batch_result

report_view.html 

report_view

Backend modules:

feature_extraction.py 

feature_extraction

live_scan.py 

live_scan

model_training.py 

model_training

predict.py 

predict

utils.py 

utils

Machine Learning Model
Model Architecture

The training pipeline (inside model_training.py) builds an ensemble of:

XGBoost Classifier

RandomForest Classifier
with soft voting for final prediction.


model_training

Feature Set

Generated by feature_extraction.py: 

feature_extraction

Lexical features such as length, entropy, digit/symbol ratio

Structural features such as subdomain depth, TLD characteristics

Suspicious keyword detection

Brand similarity scoring

Shortener detection

Heuristic continuation rate for character sequence patterns

All features go through scaling before prediction.

Live Scan Engine

Implemented in live_scan.py:


live_scan

Includes:

DNS resolution

IP address

Domain age (WHOIS)

HTTP request and latency

Redirect chain

Final URL

Lightweight risk heuristics

Runs independently of the ML model for real-world behavior monitoring.

Frontend Screenshots
Home Interface

![Home](/mnt/data/Screenshot 2025-11-21 175427.png)

Recent AI Scan Results

![Recent Scans](/mnt/data/Screenshot 2025-11-21 175441.png)

Dashboard and Metrics

![Dashboard](/mnt/data/Screenshot 2025-11-21 175448.png)

Batch Scan Interface

![Batch Scan](/mnt/data/Screenshot 2025-11-21 175452.png)

Live Scan Result

![Live Scan](/mnt/data/Screenshot 2025-11-21 175608.png)

Installation and Setup
1. Install dependencies
pip install -r requirements.txt

2. Start MongoDB

Local Docker example:

docker run -d --name mongo -p 27017:27017 mongo:6


Or set:

export MONGODB_URI="mongodb://localhost:27017/threat_analyzer"

3. Train the model (recommended)
python backend/model_training.py


Dataset path: data/phish_url.csv

Produces trained model under backend/model/.

4. Run the app
python app.py


Visit:

http://127.0.0.1:5000
